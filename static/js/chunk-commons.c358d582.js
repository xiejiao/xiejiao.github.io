(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{e0d4:function(e,t,i){"use strict";i("f811")},ec8d:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"audio-player"},[i("div",{staticClass:"audio__btn-wrap"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showPrevButton,expression:"showPrevButton"}],staticClass:"audio__play-prev",class:{disable:!e.isLoop&&0===e.currentPlayIndex},on:{click:function(t){return t.stopPropagation(),e.playPrev(t)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play-prev"}})])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showPrevButton,expression:"showPrevButton"}],staticClass:"audio__play-prev",class:{disable:!e.isLoop&&0===e.currentPlayIndex},on:{click:function(t){return t.stopPropagation(),e.playNewFragment(-1)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play-backward"}})])]),e._v(" "),e.isLoading?i("div",{staticClass:"audio__play-loading"},[i("span"),e._v(" "),i("span"),e._v(" "),i("span"),e._v(" "),i("span"),e._v(" "),i("span"),e._v(" "),i("span"),e._v(" "),i("span"),e._v(" "),i("span")]):[!e.isPlaying&&e.showPlayButton?i("div",{staticClass:"audio__play-start",on:{click:function(t){return t.stopPropagation(),e.handlePlay(t)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play"}})])]):e.showPlayButton?i("div",{staticClass:"audio__play-pause",on:{click:function(t){return t.stopPropagation(),e.handlePause(t)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play-pause"}})])]):e._e()],e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showNextButton,expression:"showNextButton"}],staticClass:"audio__play-next",class:{disable:!e.isLoop&&e.currentPlayIndex===e.audioList.length-1},on:{click:function(t){return t.stopPropagation(),e.playNewFragment(1)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play-forward"}})])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showNextButton,expression:"showNextButton"}],staticClass:"audio__play-next",class:{disable:!e.isLoop&&e.currentPlayIndex===e.audioList.length-1},on:{click:function(t){return t.stopPropagation(),e.playNext(t)}}},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-play-next"}})])]),e._v(" "),e.showVolumeButton?i("div",{staticClass:"audio__play-volume-icon-wrap"},[i("svg",{staticClass:"audio__play-icon",attrs:{"aria-hidden":"true"},on:{touchstart:e.handleVolumeIconTouchstart,mousedown:e.handleVolumeIconTouchstart}},[i("use",{attrs:{"xlink:href":e.currentVolume?"#icon-play-volume":"#icon-play-volume-no"}})]),e._v(" "),i("transition",{attrs:{name:"fade-volume"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowVolume,expression:"isShowVolume"}],ref:"playVolumeWrap",staticClass:"audio__play-volume-wrap",on:{touchstart:e.handleVolumeTouchstart,mousedown:e.handleVolumeTouchstart,touchmove:e.handleVolumeTouchmove,mousemove:e.handleVolumeTouchmove,touchend:e.handleVolumeTouchend,mouseup:e.handleVolumeTouchend}},[i("div",{ref:"playVolume",staticClass:"audio__play-volume",style:{height:100*e.currentVolume+"%"}})])])],1):e._e(),e._v(" "),i("div",{staticClass:"audio__play-rate"},[i("span",{on:{click:function(t){e.isShowRates=!e.isShowRates}}},[e._v(e._s(e._f("rateFilter")(e.playbackRate)))]),e._v(" "),i("transition",{attrs:{name:"fade-rate"}},[i("ul",{directives:[{name:"show",rawName:"v-show",value:e.isShowRates,expression:"isShowRates"}],staticClass:"audio__play-rate__dropdown"},e._l(e.playbackRates,(function(t){return i("li",{key:"pr_"+t,on:{click:function(i){return e.handleSetPlaybackRate(t)}}},[e._v("\n            "+e._s(e._f("rateFilter")(t))+"\n          ")])})),0)])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowNotice,expression:"isShowNotice"}],staticClass:"audio__notice"},[e._v("\n      "+e._s(e.noticeMessage)+"\n    ")])],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showProgressBar,expression:"showProgressBar"}],ref:"audioProgressWrap",staticClass:"audio__progress-wrap",on:{click:e.handleClickProgressWrap}},[i("div",{ref:"audioProgress",staticClass:"audio__progress"}),e._v(" "),i("div",{ref:"audioProgressPoint",staticClass:"audio__progress-point",on:{touchstart:e.handleProgressTouchstart,mousedown:e.handleProgressTouchstart,touchend:e.handleProgressTouchend,mouseup:e.handleProgressTouchend,touchmove:e.handleProgressTouchmove,mousemove:e.handleProgressTouchmove}})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showProgressBar,expression:"showProgressBar"}],staticClass:"audio__time-wrap"},[i("div",{staticClass:"audio__current-time"},[e._v("\n      "+e._s(e.currentTimeFormatted)+"\n    ")]),e._v(" "),i("div",{staticClass:"audio__duration"},[e._v("\n      "+e._s(e.durationFormatted)+"\n    ")])]),e._v(" "),i("audio",e._g(e._b({ref:"audio",staticClass:"audio-player__audio",attrs:{src:e.audioList[e.currentPlayIndex]},on:{ended:e.onEnded,timeupdate:e.onTimeUpdate,loadedmetadata:e.onLoadedmetadata}},"audio",e.$attrs,!1),e.$listeners),[e._v("\n    浏览器太老咯，请升级浏览器吧~\n  ")])])},a=[],o=(i("6b54"),i("c5f6"),{name:"AudioPlayer",inheritAttrs:!1,props:{audioList:{default:null,type:Array},showPlayButton:{default:!0,type:Boolean},showPrevButton:{default:!0,type:Boolean},showNextButton:{default:!0,type:Boolean},showVolumeButton:{default:!0,type:Boolean},showProgressBar:{default:!0,type:Boolean},beforePlay:{default:null,type:Function},beforePrev:{default:null,type:Function},beforeNext:{default:null,type:Function},isLoop:{type:Boolean,default:!0},isAutoPlayNext:{type:Boolean,default:!0},progressInterval:{default:1e3,type:Number},showPlaybackRate:{type:Boolean,default:!1},playbackRates:{type:Array,default:function(){return[.5,1,1.5,2]}}},data:function(){return{isIOS:/iPhone|iPad|iPod/i.test(window.navigator.userAgent),isPlaying:!1,isDragging:!1,isDraggingVolume:!1,isShowNotice:!1,isLoading:!1,isShowVolume:!1,isVolumeSetStart:!1,isShowRates:!1,timer:null,noticeMessage:"",duration:"",currentPlayIndex:0,currentTime:"",currentVolume:1,fragementList:[],playbackRate:1}},mounted:function(){window.addEventListener("keyup",this.handleKeyup)},destroyed:function(){window.removeEventListener("keyup",this.handleKeyup)},computed:{currentTimeFormatted:function(){return this.currentTime?this.formatTime(this.currentTime):"00:00"},durationFormatted:function(){return this.duration?this.formatTime(this.duration):"00:00"}},filters:{rateFilter:function(e){return e.toFixed(1)+"x"}},methods:{handleVolumeIconTouchstart:function(){console.log("handleVolumeIconTouchstart"),this.isShowVolume=!this.isShowVolume},handleVolumeTouchstart:function(e){this.isVolumeSetStart=!0},handleVolumeTouchmove:function(e){if(this.isVolumeSetStart){var t,i,s=this.$refs.playVolumeWrap.getBoundingClientRect(),a=0;a=this.isMobile()?e.changedTouches[0].clientY:e.clientY,this.isDraggingVolume=!0,t=Math.round(s.bottom-a),i=t/this.$refs.playVolumeWrap.offsetHeight,i=Math.min(i,1),i=Math.max(i,0),this.$refs.audio.volume=i,this.currentVolume=i}},handleVolumeTouchend:function(){this.isDraggingVolume&&(this.isShowVolume=!1,this.isVolumeSetStart=!1)},handleSetPlaybackRate:function(e){this.playbackRate=+e,this.$refs.audio.playbackRate=+e,this.isShowRates=!1},showNotice:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.noticeMessage=t.message,this.isShowNotice=!0,window.setTimeout((function(){e.isShowNotice=!1}),t.duration||3e3)},onLoadedmetadata:function(e){this.duration=this.$refs.audio.duration,this.$emit("loadedmetadata",e)},onTimeUpdate:function(e){this.$emit("timeupdate",e)},formatTime:function(e){var t;return t=Math.floor(e/60),e=Math.ceil(e%60),t+="",e+="",t=1===t.length?"0"+t:t,e=1===e.length?"0"+e:e,t+":"+e},isMobile:function(){var e=window.navigator.userAgent.indexOf("Mobile")>-1;return e},onEnded:function(e){var t=this;window.setTimeout((function(){t.pause(),t.$emit("ended",e),t.isLoop&&t.isAutoPlayNext&&t.playNext()}),1e3)},handleProgressTouchstart:function(e){this.isDragging=!0},handleProgressTouchend:function(e){this.$refs.audio.currentTime=this.currentTime,this.isDragging=!1,this.$emit("userctrl")},handleProgressTouchmove:function(e){if(this.isDragging){var t=0;if(this.isMobile()){var i=e.changedTouches[0];t=i.pageX}else t=e.pageX;var s=e.target.getBoundingClientRect(),a=parseInt(getComputedStyle(e.target).left),o=a+(t-s.left);o=Math.min(o,this.$refs.audioProgressWrap.offsetWidth),o=Math.max(o,0),this.setPointPosition(o),this.$refs.audioProgress.style.width=o+"px",this.currentTime=o/this.$refs.audioProgressWrap.offsetWidth*this.duration}},handleClickProgressWrap:function(e){var t=e.target,i=e.offsetX;t!==this.$refs.audioProgressPoint&&(this.currentTime=i/this.$refs.audioProgressWrap.offsetWidth*this.duration,this.$refs.audio.currentTime=this.currentTime,this.setPointPosition(i),this.$refs.audioProgress.style.width=i+"px")},setPointPosition:function(e){this.$refs.audioProgressPoint.style.left=e-this.$refs.audioProgressPoint.offsetWidth/2+"px"},playing:function(){if(!this.isDragging){var e=this.$refs.audio.currentTime/this.$refs.audio.duration*this.$refs.audioProgressWrap.offsetWidth;this.currentTime=this.$refs.audio.currentTime,this.$refs.audioProgress.style.width=e+"px",this.$refs.audioProgressPoint.style.left=e-this.$refs.audioProgressPoint.offsetWidth/2+"px",this.$emit("playing")}},setCurrentTime:function(e){this.clearTimer(),this.currentTime=e,this.$refs.audio.currentTime=this.currentTime},handlePlay:function(){this.$emit("userctrl"),this.play()},play:function(){var e=this;this.isLoading=!0;var t=function(){e.$refs.audio.play().then((function(t){e.$nextTick((function(){e.playing(),e.timer=window.setInterval(e.playing,e.progressInterval),e.isPlaying=!0,e.isLoading=!1}))})).catch((function(t){9===t.code&&(e.showNotice({message:"加载失败，因为没有找到支持的源。"}),e.isAutoPlayNext&&window.setTimeout((function(){e.playNext()}),1e3)),e.isLoading=!1})),e.$emit("play")};this.isIOS&&(console.log("下面一行的错误是解决 iOS 异步请求后无法播放问题"),this.$refs.audio.play(),this.$refs.audio.pause()),this.beforePlay?this.beforePlay((function(e){!1!==e&&t()})):t()},handlePause:function(){this.$emit("userctrl"),this.pause()},pause:function(){var e=this;this.$refs.audio.pause(),this.$nextTick((function(){e.clearTimer(),e.isPlaying=!1,e.$emit("pause")}))},playPrev:function(){var e=this;if(!(this.currentPlayIndex<=0)||this.isLoop){this.clearTimer();var t=function(){e.currentPlayIndex<=0&&e.isLoop?e.currentPlayIndex=e.audioList.length-1:e.currentPlayIndex--,e.$nextTick((function(){e.play(),e.$emit("play-prev")}))};this.beforePrev?this.beforePrev((function(e){!1!==e&&t()})):t()}},clearTimer:function(){window.clearInterval(this.timer),this.timer=null},playNext:function(){var e=this;if(!(this.currentPlayIndex+1>=this.audioList.length)||this.isLoop){this.clearTimer();var t=function(){e.currentPlayIndex+1>=e.audioList.length&&e.isLoop?e.currentPlayIndex=0:e.currentPlayIndex++,e.$nextTick((function(){e.play(),e.$emit("play-next")}))};this.beforeNext?this.beforeNext((function(e){!1!==e&&t()})):t()}},handleKeyup:function(e){if("TEXTAREA"!=e.target.nodeName&&"INPUT"!=e.target.nodeName){var t=e||window.event||arguments.callee.caller.arguments[0];if(t){t.key;var i=t.keyCode;32==i&&(this.$emit("userctrl"),this.isPlaying?(this.pause(),this.fragementList.push(this.currentTime.toFixed(3)),console.log("this.fragementList:",this.fragementList.toString())):this.play())}}},playNewFragment:function(e){this.$store.dispatch("lesson/setCurrIdOffset",e)}},beforeDestroy:function(){this.pause()}}),n=o,r=(i("e0d4"),i("2877")),u=Object(r["a"])(n,s,a,!1,null,null,null);t["a"]=u.exports},f811:function(e,t,i){}}]);